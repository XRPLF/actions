name: Cleanup GitHub workspace
description: Remove all the files and directories in the GitHub workspace

runs:
  using: composite
  steps:
    - name: Do the cleanup
      if: ${{ runner.os == 'macOS' }}
      shell: bash
      run: |
        WORKSPACE=${{ github.workspace }}
        if [ -z "$WORKSPACE" ] || [ "$WORKSPACE" = "/" ]; then
            echo "Invalid directory: '$WORKSPACE'"
            exit 1
        fi
        find "$WORKSPACE" -depth 1 | xargs rm -rfv

    - name: Fail if not MacOS
      if: ${{ runner.os != 'macOS' }}
      shell: bash
      run: |
        echo "This action only supports MacOS."
        exit 1
